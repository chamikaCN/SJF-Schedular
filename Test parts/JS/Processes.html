<!DOCTYPE html>
<html lang="en">
<head>
<link href="Processes.css" rel="stylesheet" type="text/css">
<title>testingSchedular1.0</title>
<h1>Schedular</h1>
</head>
<body>
    <form name="Inputform">
        Number of processes   <input type="number" id="num" value="5"/>
        <button type= "button" id="okbutton" onclick="inputNum()"> OK </button><br/><br/>
        <input type="text" id= "ProName" placeholder="Process name "/>
        <input type="number" id= "SubTime" placeholder="Submission time "/>
        <input type="number" id= "BurstTime" placeholder="Burst time "/>
        <button type= "button" id="Addbutton" onclick="addToArray()"> add <br/></button>
        <button type= "button" id="delete" onclick="deleteFromArray()"> delete last entry <br/></button>
        <button type= "button" id="Submitbutton" onclick="submission()"> Calculate </button>

        <div>
            <p id="errors"></p>
            <p id="answer"></p> 
            <ul id="testing"></ul> 
            <ul id="testing1"></ul>
            <p id= "test2"></p>

        </div>

        <script>
            
            var processes = [];
            var numberOfProcesses; 
            function inputNum(){
                numberOfProcesses = parseInt(document.getElementById("num").value,10);
                
                //document.getElementById("answer").innerText = processes.length ;
            }
        
            function addToArray(){
                
                if (processes.length < numberOfProcesses){
                    processes.push([(document.getElementById("ProName").value).toString(),parseInt(document.getElementById("SubTime")
                    .value,10),parseInt(document.getElementById("BurstTime").value,10)]);
                    document.getElementById("answer").innerText = processes.join() ;
                    document.getElementById("errors").innerText = processes.length;
                }else{
                    document.getElementById("Addbutton").disabled = true;
                }
            }

            function deleteFromArray(){

                if (processes.length == 0){
                    document.getElementById("errors".innerText = "No processes to Delete");
                }else{
                    processes.pop();
                    console.log(processes);
                    document.getElementById("Addbutton").disabled = false;
                    document.getElementById("answer").innerText = processes.join() ;
                    document.getElementById("errors").innerText = processes.length;


                }
            }

            function nextSJ(processList,time){
                var minPro;
                var minVal = 10000000;
                //processList.forEach(p => {
                for (var p = 0; p <processList.length ;p++){
                    if ((processList[p][2] < minVal) && (time >= processList[p][1])){
                        minVal = processList[p][2];
                        minindex = p;
                    }
                }
                var item1 = createTodoItem(processList[minindex]);
                attachTodoItem(item1);
                //document.getElementById("test2").innerText = processList.splice(minindex,1);
                return processList.splice(minindex,1);
            }

            function submission(){
                document.getElementById("errors").innerText = "good";

                var timeIndex = 0;
                while(processes.length > 0 ){
                    document.getElementById("errors").innerText = "good0.5";

                    var shortestJob = nextSJ(processes,timeIndex);
                    var cat = shortestJob.join() + " executes at second " + timeIndex.toString();
                    document.getElementById("errors").innerText = "good1";
                    //document.getElementById("testing").appendChild(cat.toString());
                    var item = createTodoItem(cat);
                    attachTodoItem(item);
                    timeIndex += shortestJob[0][2];
                    document.getElementById("errors").innerText = "good2";
                }

                //nextSJ(processes,0);
                //nextSJ(processes,4);
                
            }

            function createTodoItem(value) {
                    var item = document.createElement('li');
                    item.innerText = value;
                    return item;
                }

                function attachTodoItem(item) {
                    var ulElement = document.getElementById('testing');
                    ulElement.appendChild(item);
                }

        </script>
        
</body>